# Generated by Django 4.2.26 on 2025-11-22 08:53

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='KnowledgeNodeModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('node_id', models.CharField(db_index=True, max_length=100, unique=True, verbose_name='节点ID')),
                ('node_type', models.CharField(choices=[('concept', '概念'), ('pattern', '模式'), ('rule', '规则'), ('symbol', '标的'), ('event', '事件'), ('strategy', '策略'), ('indicator', '指标')], db_index=True, max_length=50, verbose_name='节点类型')),
                ('name', models.CharField(max_length=200, verbose_name='名称')),
                ('description', models.TextField(verbose_name='描述')),
                ('properties', models.JSONField(default=dict, verbose_name='属性')),
                ('importance', models.IntegerField(default=50, verbose_name='重要性(0-100)')),
                ('reference_count', models.IntegerField(default=0, verbose_name='引用次数')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
            ],
            options={
                'verbose_name': '知识节点',
                'verbose_name_plural': '知识节点',
                'db_table': 'knowledge_node',
            },
        ),
        migrations.CreateModel(
            name='MarketPatternModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('pattern_type', models.CharField(choices=[('technical', '技术形态'), ('sentiment', '情绪模式'), ('cycle', '周期模式'), ('correlation', '相关性模式'), ('anomaly', '异常模式')], db_index=True, max_length=50, verbose_name='模式类型')),
                ('name', models.CharField(max_length=200, verbose_name='模式名称')),
                ('description', models.TextField(verbose_name='描述')),
                ('features', models.JSONField(default=dict, verbose_name='特征')),
                ('detection_rules', models.JSONField(default=dict, verbose_name='检测规则')),
                ('occurrence_count', models.IntegerField(default=0, verbose_name='出现次数')),
                ('success_count', models.IntegerField(default=0, verbose_name='成功次数')),
                ('avg_return', models.DecimalField(blank=True, decimal_places=4, max_digits=10, null=True, verbose_name='平均收益率')),
                ('applicable_markets', models.JSONField(blank=True, default=list, verbose_name='适用市场')),
                ('applicable_symbols', models.JSONField(blank=True, default=list, verbose_name='适用标的')),
                ('confidence', models.DecimalField(decimal_places=2, default=0.5, max_digits=5, verbose_name='置信度')),
                ('last_detected', models.DateTimeField(blank=True, null=True, verbose_name='最后检测到')),
                ('last_detection_symbols', models.JSONField(blank=True, default=list, verbose_name='最后检测标的')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否活跃')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
            ],
            options={
                'verbose_name': '市场模式',
                'verbose_name_plural': '市场模式',
                'db_table': 'market_pattern',
                'ordering': ['-confidence', '-occurrence_count'],
            },
        ),
        migrations.CreateModel(
            name='TradingPrincipleModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('principle_type', models.CharField(choices=[('entry', '入场原则'), ('exit', '出场原则'), ('risk', '风控原则'), ('position', '仓位管理'), ('market', '市场判断'), ('general', '通用原则')], db_index=True, max_length=50, verbose_name='原则类型')),
                ('title', models.CharField(max_length=200, verbose_name='标题')),
                ('content', models.TextField(verbose_name='内容')),
                ('conditions', models.JSONField(blank=True, default=dict, verbose_name='适用条件')),
                ('applicable_scenarios', models.JSONField(blank=True, default=list, verbose_name='适用场景')),
                ('source', models.CharField(choices=[('learned', 'AI学习'), ('manual', '人工添加'), ('evolved', '进化生成')], max_length=50, verbose_name='来源')),
                ('derived_from', models.JSONField(blank=True, default=list, verbose_name='衍生自（记忆ID列表）')),
                ('validation_count', models.IntegerField(default=0, verbose_name='验证次数')),
                ('success_count', models.IntegerField(default=0, verbose_name='成功次数')),
                ('fail_count', models.IntegerField(default=0, verbose_name='失败次数')),
                ('success_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='成功率')),
                ('priority', models.IntegerField(default=50, verbose_name='优先级(0-100)')),
                ('is_active', models.BooleanField(default=True, verbose_name='是否启用')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
            ],
            options={
                'verbose_name': '交易原则',
                'verbose_name_plural': '交易原则',
                'db_table': 'trading_principle',
                'ordering': ['-priority', '-created_at'],
                'indexes': [models.Index(fields=['principle_type', 'is_active'], name='trading_pri_princip_d197ff_idx'), models.Index(fields=['-priority', 'is_active'], name='trading_pri_priorit_4d2189_idx')],
            },
        ),
        migrations.CreateModel(
            name='CognitiveBiasLogModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('bias_type', models.CharField(choices=[('overtrading', '过度交易'), ('anchoring', '锚定效应'), ('confirmation', '确认偏差'), ('loss_aversion', '损失厌恶'), ('recency', '近因效应'), ('overconfidence', '过度自信'), ('herding', '羊群效应')], db_index=True, max_length=50, verbose_name='偏见类型')),
                ('detected_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='检测时间')),
                ('description', models.TextField(verbose_name='描述')),
                ('evidence', models.JSONField(default=dict, verbose_name='证据')),
                ('impact_level', models.IntegerField(verbose_name='影响等级(1-10)')),
                ('affected_decisions', models.JSONField(blank=True, default=list, verbose_name='受影响的决策')),
                ('correction_measures', models.JSONField(blank=True, default=list, verbose_name='纠正措施')),
                ('is_corrected', models.BooleanField(default=False, verbose_name='是否已纠正')),
                ('corrected_at', models.DateTimeField(blank=True, null=True, verbose_name='纠正时间')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
            ],
            options={
                'verbose_name': '认知偏见日志',
                'verbose_name_plural': '认知偏见日志',
                'db_table': 'cognitive_bias_log',
                'ordering': ['-detected_at'],
                'indexes': [models.Index(fields=['bias_type', '-detected_at'], name='cognitive_b_bias_ty_d30e40_idx'), models.Index(fields=['is_corrected', '-detected_at'], name='cognitive_b_is_corr_921a38_idx')],
            },
        ),
        migrations.CreateModel(
            name='AgentMemoryModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('memory_type', models.CharField(choices=[('working', '工作记忆'), ('short_term', '短期记忆'), ('long_term', '长期记忆'), ('episodic', '情景记忆')], db_index=True, max_length=20, verbose_name='记忆类型')),
                ('content', models.TextField(verbose_name='记忆内容')),
                ('summary', models.CharField(blank=True, max_length=500, null=True, verbose_name='摘要')),
                ('importance_score', models.DecimalField(db_index=True, decimal_places=2, max_digits=5, verbose_name='重要性分数(0-10)')),
                ('metadata', models.JSONField(default=dict, verbose_name='元数据')),
                ('tags', models.JSONField(blank=True, default=list, verbose_name='标签')),
                ('when', models.DateTimeField(blank=True, null=True, verbose_name='何时')),
                ('where', models.CharField(blank=True, max_length=200, null=True, verbose_name='何地')),
                ('what', models.CharField(blank=True, max_length=500, null=True, verbose_name='何事')),
                ('who', models.CharField(blank=True, max_length=200, null=True, verbose_name='何人')),
                ('why', models.TextField(blank=True, null=True, verbose_name='为何')),
                ('how', models.TextField(blank=True, null=True, verbose_name='如何')),
                ('related_symbols', models.JSONField(blank=True, default=list, verbose_name='相关标的')),
                ('related_strategies', models.JSONField(blank=True, default=list, verbose_name='相关策略')),
                ('related_trades', models.JSONField(blank=True, default=list, verbose_name='相关交易')),
                ('vector_id', models.CharField(blank=True, db_index=True, max_length=100, null=True, verbose_name='向量ID')),
                ('source', models.CharField(max_length=100, verbose_name='来源')),
                ('source_id', models.CharField(blank=True, max_length=100, null=True, verbose_name='来源ID')),
                ('access_count', models.IntegerField(default=0, verbose_name='访问次数')),
                ('last_accessed', models.DateTimeField(blank=True, null=True, verbose_name='最后访问时间')),
                ('is_valuable', models.BooleanField(blank=True, null=True, verbose_name='是否有价值')),
                ('value_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='价值分数')),
                ('is_forgotten', models.BooleanField(default=False, verbose_name='是否已遗忘')),
                ('forgotten_at', models.DateTimeField(blank=True, null=True, verbose_name='遗忘时间')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
            ],
            options={
                'verbose_name': '智能体记忆',
                'verbose_name_plural': '智能体记忆',
                'db_table': 'agent_memory',
                'ordering': ['-importance_score', '-created_at'],
                'indexes': [models.Index(fields=['memory_type', '-importance_score'], name='agent_memor_memory__529ec2_idx'), models.Index(fields=['is_forgotten', '-created_at'], name='agent_memor_is_forg_a97d58_idx'), models.Index(fields=['-importance_score', '-created_at'], name='agent_memor_importa_7dc169_idx')],
            },
        ),
        migrations.CreateModel(
            name='KnowledgeEdgeModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('relationship', models.CharField(choices=[('leads_to', '导致'), ('correlates_with', '相关'), ('opposes', '对立'), ('contains', '包含'), ('part_of', '属于'), ('precedes', '先于'), ('follows', '后于'), ('causes', '引起'), ('similar_to', '相似')], max_length=50, verbose_name='关系类型')),
                ('weight', models.DecimalField(decimal_places=2, default=1.0, max_digits=5, verbose_name='权重(0-1)')),
                ('confidence', models.DecimalField(decimal_places=2, default=0.5, max_digits=5, verbose_name='置信度(0-1)')),
                ('properties', models.JSONField(blank=True, default=dict, verbose_name='属性')),
                ('evidence_count', models.IntegerField(default=0, verbose_name='证据数量')),
                ('evidence', models.JSONField(blank=True, default=list, verbose_name='证据列表')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
                ('from_node', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='outgoing_edges', to='memory.knowledgenodemodel', verbose_name='源节点')),
                ('to_node', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='incoming_edges', to='memory.knowledgenodemodel', verbose_name='目标节点')),
            ],
            options={
                'verbose_name': '知识关系',
                'verbose_name_plural': '知识关系',
                'db_table': 'knowledge_edge',
                'indexes': [models.Index(fields=['from_node', 'relationship'], name='knowledge_e_from_no_ce57b0_idx'), models.Index(fields=['to_node', 'relationship'], name='knowledge_e_to_node_38c9e7_idx')],
                'unique_together': {('from_node', 'to_node', 'relationship')},
            },
        ),
    ]
